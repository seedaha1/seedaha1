<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Ù„Ø¹Ø¨Ø© ØµÙŠØ¯Ù‡Ø§ - Ø§Ù„Ø°Ø§ÙƒØ±Ø© Ø§Ù„Ø¹Ø§Ø¦Ù„ÙŠØ©</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #e6f7ff;
            color: #222;
            text-align: center;
            padding: 20px;
            direction: rtl;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            margin: 0;
            position: relative;
        }

        /* Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø© Ø§Ù„Ù‚Ø§Ù†ÙˆÙ†ÙŠØ© */
        .legal-notice {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            background-color: #ffe0b2;
            color: #8d6e63;
            padding: 8px 15px;
            font-size: 14px;
            font-weight: bold;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            z-index: 1000;
            border-bottom: 1px solid #d7ccc8;
            line-height: 1.5;
            text-align: center;
        }
        .legal-notice span {
            display: block;
            margin-top: 5px;
            font-style: italic;
            font-weight: normal;
        }

        /* Ù†Ø§ÙØ°Ø© Ø§Ù„Ù…ÙˆØ¯Ø§Ù„ */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 2000;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s ease-out;
        }

        .modal-overlay.show {
            opacity: 1;
            pointer-events: auto;
            display: flex;
        }

        .modal-content {
            background-color: #ffffff;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.3);
            max-width: 600px;
            width: 90%;
            text-align: center;
            line-height: 1.6;
            animation: fadeIn 0.3s ease-out;
            max-height: 90vh;
            overflow-y: auto;
            color: #333;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .modal-content h2 {
            color: #007bff;
            margin-bottom: 20px;
            font-size: 2em;
        }

        .modal-content ul {
            list-style: none;
            padding: 0;
            margin: 20px 0;
        }

        .modal-content ul li {
            margin-bottom: 10px;
            font-size: 1.1em;
            text-align: right;
            padding-right: 10px;
            border-right: 3px solid #007bff;
        }

        .modal-content p {
            font-size: 1.1em;
            margin-top: 25px;
            font-weight: bold;
            color: #555;
        }
        .modal-content .button-group {
            margin-top: 30px;
        }
        .modal-content button {
            background-color: #004080;
            color: white;
            border: none;
            padding: 18px 35px;
            border-radius: 8px;
            font-size: 1.3em;
            cursor: pointer;
            transition: background-color 0.3s ease;
            margin: 0 10px;
        }
        .modal-content button:hover {
            background-color: #003366;
        }

        /* Welcome Modal Specific Styles */
        #welcomeModal .modal-content h2 {
            color: #004080;
            margin-bottom: 25px;
        }
        #welcomeModal .modal-content img {
            max-width: 80%;
            height: auto;
            margin-bottom: 30px;
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }
        #welcomeModal .modal-content button {
            background-color: #004080;
            color: white;
            padding: 18px 40px;
            font-size: 1.4em;
        }
        #welcomeModal .modal-content button:hover {
            background-color: #003366;
        }


        /* Ø´Ø§Ø´Ø© Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„ÙØ±Ù‚ */
        #teamSelectionModal .team-options {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 30px;
            flex-wrap: wrap;
        }
        #teamSelectionModal .team-options button {
            background-color: #004080;
            font-size: 1.3em;
            padding: 18px 35px;
        }
        #teamSelectionModal .team-options button:hover {
            background-color: #003366;
        }

        /* Ø´Ø§Ø´Ø© ØªØ³Ù…ÙŠØ© Ø§Ù„ÙØ±Ù‚ */
        #teamNameInputModal .team-name-inputs {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-top: 20px;
        }
        #teamNameInputModal .team-name-inputs div {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        #teamNameInputModal .team-name-inputs label {
            font-weight: bold;
            min-width: 80px;
            text-align: right;
            color: #007bff;
        }
        #teamNameInputModal .team-name-inputs input[type="text"] {
            flex-grow: 1;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 1.1em;
            text-align: right;
        }
        #teamNameInputModal .team-name-inputs input[type="text"]:focus {
            border-color: #007bff;
            outline: none;
            box-shadow: 0 0 5px rgba(0, 123, 255, 0.3);
        }


        /* Ø§Ù„ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© Ù„Ù„Ø¹Ø¨Ø© */
        .game-area {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            width: 100%;
            max-width: 900px;
            padding: 0 10px;
            box-sizing: border-box;
            margin-top: 60px;
        }

        .scoreboard {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin: 20px 0 10px;
            flex-wrap: wrap;
        }

        .team {
            padding: 12px 20px;
            border-radius: 12px;
            background: #e0f7fa;
            font-weight: bold;
            font-size: 1.1em;
            min-width: 120px;
            border: 3px solid transparent;
            transition: all 0.2s ease-in-out;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.15);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            flex: 1 1 auto;
            min-width: 140px;
            max-width: 200px;
        }
        .team span {
            font-size: 1.8em;
            margin-top: 5px;
            color: #004085;
        }

        /* Ø£Ù„ÙˆØ§Ù† Ø§Ù„ÙØ±Ù‚ */
        .blue { background-color: #cce5ff; color: #004085; }
        .red { background-color: #f8d7da; color: #721c24; }
        .green { background-color: #d4edda; color: #155724; }
        .orange { background-color: #fff3cd; color: #856404; }

        /* ØªÙ…ÙŠÙŠØ² Ø§Ù„ÙØ±ÙŠÙ‚ Ø§Ù„Ø°ÙŠ Ø¹Ù„ÙŠÙ‡ Ø§Ù„Ø¯ÙˆØ± */
        .team.active {
            border-color: #007bff;
            box-shadow: 0 0 12px rgba(0, 123, 255, 0.6);
            transform: translateY(-5px);
        }

        .controls {
            margin: 20px 0;
            display: flex;
            justify-content: center;
            gap: 15px;
            flex-wrap: wrap;
        }

        .controls button {
            background-color: #004080;
            color: white;
            border: none;
            padding: 18px 35px;
            border-radius: 10px;
            font-size: 1.3em;
            margin: 0;
            cursor: pointer;
            transition: background 0.3s ease, transform 0.2s ease;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            flex: 1 1 auto;
            min-width: 150px;
            max-width: 250px;
        }

        .controls button:hover {
            background-color: #003366;
            transform: translateY(-2px);
        }

        .controls button:disabled {
            background-color: #cccccc;
            cursor: not-allowed;
            box-shadow: none;
            transform: none;
        }

        .timer {
            font-size: 28px;
            font-weight: bold;
            margin-bottom: 15px;
            color: #333;
            min-height: 35px;
        }

        /* Ø§Ù„ØªØ®Ø·ÙŠØ· Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ Ù„Ù„Ø´Ø¨ÙƒØ© */
        .grid {
            display: grid;
            grid-gap: 20px;
            justify-content: center;
            margin: 20px auto;
            max-width: fit-content;
        }

        /* Ø£Ø­Ø¬Ø§Ù… Ø§Ù„Ø®Ù„Ø§ÙŠØ§ Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ© */
        .cell {
            border-radius: 15px;
            background-color: #ffffff;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: 0 0 8px rgba(0, 0, 0, 0.3);
            transition: background-color 0.3s ease, color 0.3s ease, transform 0.2s ease, filter 0.3s ease;
            user-select: none;
            color: #222;
            text-align: center;
            line-height: 1.2;
            padding: 5px;
            box-sizing: border-box;
        }
        .cell:not(.matched):not(.empty):hover {
            transform: scale(1.05);
        }

        /* Ø§Ù„Ø®Ù„Ø§ÙŠØ§ Ø§Ù„ÙØ§Ø±ØºØ© */
        .cell.empty {
            background-color: transparent;
            box-shadow: none;
            cursor: default;
            pointer-events: none;
        }

        /* Ù‡Ø°Ø§ Ù‡Ùˆ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„ØµØ­ÙŠØ­ Ù„Ø­Ù„ Ù…Ø´ÙƒÙ„Ø© iOS */
        .cell.hidden {
            background-color: #0055AA;
            cursor: pointer;
        }
        /* Ø§Ù„Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„ØªÙŠ ØªØ­Ù„ Ø§Ù„Ù…Ø´ÙƒÙ„Ø©: Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ù…Ø­ØªÙˆÙ‰ ØªÙ…Ø§Ù…Ù‹Ø§ */
        .cell.hidden span {
            visibility: hidden;
            font-size: 0;
            color: transparent;
        }


        .cell.matched {
            background-color: #a3cfbb;
            cursor: default;
            pointer-events: none;
            transform: none;
            box-shadow: inset 0 0 5px rgba(0, 0, 0, 0.2);
        }

        /* Ù†Ù…Ø· Ø®Ø§Øµ Ù„Ø¨Ø·Ø§Ù‚Ø© +/- 1 Ø¹Ù†Ø¯ Ø§Ù„ÙƒØ´Ù Ø¹Ù†Ù‡Ø§ ÙÙŠ Ù…Ø±Ø­Ù„Ø© Ø§Ù„Ù„Ø¹Ø¨ */
        .cell.value-revealed {
            font-weight: bold;
            font-size: 4em;
            transform: none;
            color: white !important;
        }
        .cell.value-revealed.negative {
            background-color: #dc3545;
        }
        .cell.value-revealed.positive {
            background-color: #28a745;
        }

        /* Ø£Ø­Ø¬Ø§Ù… Ø§Ù„Ø´Ø¨ÙƒØ© Ø­Ø³Ø¨ Ø§Ù„Ø¬ÙˆÙ„Ø© */
        /* Ø¬ÙˆÙ„Ø§Øª 14 Ù…Ø±Ø¨Ø¹Ù‹Ø§ -> ØªØ®Ø·ÙŠØ· 2x7 (Ù„Ù„Ù…Ø¬Ù…ÙˆØ¹Ø© Ø§Ù„Ø£ÙˆÙ„Ù‰) */
        .grid.size-14 { grid-template-columns: repeat(7, 120px); grid-template-rows: repeat(2, 120px); }
        .grid.size-14 .cell { width: 120px; height: 120px; }

        /* Ø¬ÙˆÙ„Ø§Øª 16 Ù…Ø±Ø¨Ø¹Ù‹Ø§ -> ØªØ®Ø·ÙŠØ· 4x4 (Ù„Ù„Ù…Ø¬Ù…ÙˆØ¹Ø© Ø§Ù„Ø«Ø§Ù†ÙŠØ©) */
        .grid.size-16 { grid-template-columns: repeat(4, 120px); grid-template-rows: repeat(4, 120px); }
        .grid.size-16 .cell { width: 120px; height: 120px; }

        /* Ø¬ÙˆÙ„Ø§Øª 18 Ù…Ø±Ø¨Ø¹Ù‹Ø§ -> ØªØ®Ø·ÙŠØ· 3x6 (Ù„Ù„Ù…Ø¬Ù…ÙˆØ¹Ø© Ø§Ù„Ø«Ø§Ù„Ø«Ø©) */
        .grid.size-18 { grid-template-columns: repeat(6, 110px); grid-template-rows: repeat(3, 110px); }
        .grid.size-18 .cell { width: 110px; height: 110px; }


        /* Ù†Ù…Ø· Ø®Ø§Øµ Ù„Ù„Ø®Ù„Ø§ÙŠØ§ Ø§Ù„ØªÙŠ ØªØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ù†ØµÙˆØµ Ø£Ùˆ Ø£Ø±Ù‚Ø§Ù… Ø­Ø³Ø§Ø¨ÙŠØ© */
        .cell.text-content {
            font-size: 35px;
            font-weight: bold;
            display: flex;
            align-items: center;
            justify-content: center;
            white-space: normal;
            word-break: break-word;
        }

        /* ØªØ¹Ø¯ÙŠÙ„Ø§Øª Ù…Ø­Ø¯Ø¯Ø© Ù„Ù„Ø®Ø· Ù„Ø¬ÙˆÙ„Ø§Øª Ø§Ù„ÙƒÙ„Ù…Ø§Øª ÙˆØ§Ù„Ù…Ø±Ø§Ø¯ÙØ§Øª/Ø§Ù„Ø£Ø¶Ø¯Ø§Ø¯ ÙˆØ§Ù„Ø¹Ù…Ù„ÙŠØ§Øª Ø§Ù„Ø­Ø³Ø§Ø¨ÙŠØ© */
        .cell[data-round-type="words"],
        .cell[data-round-type="math"],
        .cell[data-round-type="letter-word"],
        .cell[data-round-type="incomplete-word"] {
            font-size: 30px;
        }
        /* ØªØ¹Ø¯ÙŠÙ„ Ø®Ø§Øµ Ù„Ø­Ø¬Ù… Ø®Ø· Ø§Ù„Ø¥ÙŠÙ…ÙˆØ¬ÙŠ ÙˆØ§Ù„Ù†Ø¬Ù…Ø© */
        .cell[data-round-type="emoji"],
        .cell[data-special-type="star-placeholder"] {
            font-size: 45px;
        }


        /* Ù…ÙƒØ§Ù† ÙˆØªØµÙ…ÙŠÙ… Ø±Ø³Ø§Ù„Ø© "Ø¯ÙˆØ± Ø§Ù„ÙØ±ÙŠÙ‚" */
        .result {
            margin-top: 10px;
            margin-bottom: 20px;
            font-size: 24px;
            font-weight: bold;
            color: #007bff;
            min-height: 30px;
        }

        /* ØªØ£Ø«ÙŠØ± Ø§Ù„Ø­Ø±ÙˆÙ Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ø§Ù„Ù…ØªØ³Ø§Ù‚Ø·Ø© */
        .falling-letter {
            position: absolute;
            top: -50px;
            font-size: 2.5em;
            color: rgba(0, 51, 102, 0.3);
            animation: fall linear infinite;
            pointer-events: none;
            user-select: none;
            opacity: 0;
            z-index: -1;
        }

        @keyframes fall {
            0% { transform: translateY(-50px) rotateZ(0deg); opacity: 1; }
            10% { opacity: 0.7; }
            90% { opacity: 0; }
            100% { transform: translateY(100vh) rotateZ(720deg); opacity: 0; }
        }

        /* Ø´Ø§Ø´Ø© Ø§Ù„Ø¹Ø¯ Ø§Ù„ØªÙ†Ø§Ø²Ù„ÙŠ Ø§Ù„ÙØ®Ù…Ø© */
        #countdownOverlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            color: white;
            font-size: 5em;
            font-weight: bold;
            z-index: 3000;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s ease-in-out;
        }

        #countdownOverlay.show {
            opacity: 1;
            pointer-events: auto;
        }

        #countdownText {
            margin-bottom: 20px;
            font-size: 0.5em;
            text-align: center;
        }

        #countdownNumber {
            font-size: 2em;
            animation: pulse 1s infinite alternate;
        }

        @keyframes pulse {
            from { transform: scale(1); opacity: 1; }
            to { transform: scale(1.1); opacity: 0.8; }
        }

        /* Ø´Ø§Ø´Ø© Ø§Ù„ÙÙˆØ² Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ© */
        #finalWinnerModal {
            color: white;
            z-index: 4000;
            text-shadow: 2px 2px 8px rgba(0,0,0,0.5);
        }

        #finalWinnerModal.show {
            opacity: 1;
            pointer-events: auto;
        }

        #finalWinnerModal h2 {
            font-size: 4em;
            margin-bottom: 30px;
            color: #ffd700;
            text-shadow: 3px 3px 10px rgba(255,165,0,0.8);
        }
        #finalWinnerModal p {
            font-size: 2em;
            margin-bottom: 40px;
        }

        #finalWinnerModal button {
            background-color: #004080;
            color: white;
            border: none;
            padding: 20px 40px;
            border-radius: 10px;
            font-size: 1.5em;
            cursor: pointer;
            transition: background-color 0.3s ease, transform 0.2s ease;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            margin: 0 10px;
        }

        #finalWinnerModal button:hover {
            background-color: #003366;
            transform: translateY(-3px);
        }

        /* ØªØ£Ø«ÙŠØ± Ø§Ù„Ù‚ØµØ§ØµØ§Øª */
        .confetti {
            position: absolute;
            width: 10px;
            height: 10px;
            background-color: #f00;
            animation: fallConfetti 5s linear forwards;
            opacity: 0;
            border-radius: 50%;
        }

        @keyframes fallConfetti {
            0% { transform: translateY(-100px) rotateZ(0deg); opacity: 1; }
            100% { transform: translateY(120vh) rotateZ(720deg); opacity: 0; }
        }

        /* Responsive Adjustments */
        @media (max-width: 768px) {
            .legal-notice {
                font-size: 12px;
                padding: 5px 10px;
            }
            .modal-content {
                padding: 20px;
                width: 95%;
            }
            .modal-content h2 {
                font-size: 1.8em;
            }
            .modal-content ul li, .modal-content p {
                font-size: 1em;
            }
            .modal-content button {
                padding: 15px 25px;
                font-size: 1.1em;
                margin: 5px;
            }

            #teamSelectionModal .team-options button,
            .controls button {
                padding: 15px 25px;
                font-size: 1.1em;
            }

            .scoreboard {
                gap: 10px;
            }
            .team {
                padding: 8px 15px;
                font-size: 0.9em;
                min-width: 100px;
            }
            .team span {
                font-size: 1.5em;
            }

            .timer {
                font-size: 22px;
            }
            .result {
                font-size: 20px;
            }

            /* Adjust grid and cell sizes for smaller screens */
            .grid.size-14 {
                grid-template-columns: repeat(4, 80px);
                grid-template-rows: repeat(3, 80px);
            }
            .grid.size-14 .cell {
                width: 80px;
                height: 80px;
            }
            
            .grid.size-16 {
                grid-template-columns: repeat(4, 80px);
                grid-template-rows: repeat(4, 80px);
            }
            .grid.size-16 .cell {
                width: 80px;
                height: 80px;
            }

            .grid.size-18 {
                grid-template-columns: repeat(3, 90px);
                grid-template-rows: repeat(6, 90px);
            }
            .grid.size-18 .cell {
                width: 90px;
                height: 90px;
            }

            .cell.text-content,
            .cell[data-round-type="words"],
            .cell[data-round-type="math"],
            .cell[data-round-type="letter-word"],
            .cell[data-round-type="incomplete-word"] {
                font-size: 24px;
            }
            .cell[data-round-type="emoji"],
            .cell[data-special-type="star-placeholder"] {
                font-size: 35px;
            }
            .cell.value-revealed {
                font-size: 3em;
            }

            #countdownNumber {
                font-size: 1.5em;
            }
            #countdownText {
                font-size: 0.4em;
            }

            #finalWinnerModal h2 {
                font-size: 3em;
            }
            #finalWinnerModal p {
                font-size: 1.5em;
            }
            #finalWinnerModal button {
                padding: 15px 30px;
                font-size: 1.2em;
            }
        }

        @media (max-width: 480px) {
            .modal-content {
                padding: 15px;
            }
            .modal-content h2 {
                font-size: 1.5em;
            }
            .modal-content ul li, .modal-content p {
                font-size: 0.9em;
            }
            .modal-content button {
                padding: 12px 20px;
                font-size: 1em;
            }

            #welcomeModal .modal-content h2 {
                font-size: 1.8em;
            }
            #welcomeModal .modal-content button {
                padding: 15px 30px;
                font-size: 1.2em;
            }

            #teamSelectionModal .team-options button,
            .controls button {
                padding: 12px 20px;
                font-size: 1em;
                min-width: unset;
                flex: 1 1 100%;
            }

            .team {
                min-width: unset;
                font-size: 0.8em;
                padding: 6px 10px;
            }
            .team span {
                font-size: 1.2em;
            }
            .scoreboard {
                flex-direction: column;
                gap: 5px;
            }

            .timer {
                font-size: 18px;
            }
            .result {
                font-size: 18px;
            }

            /* Further reduce cell sizes for very small screens */
            .grid.size-14 {
                grid-template-columns: repeat(4, 60px);
                grid-template-rows: repeat(3, 60px);
            }
            .grid.size-14 .cell {
                width: 60px;
                height: 60px;
            }

            .grid.size-16 {
                grid-template-columns: repeat(4, 60px);
                grid-template-rows: repeat(4, 60px);
            }
            .grid.size-16 .cell {
                width: 60px;
                height: 60px;
            }

            .grid.size-18 {
                grid-template-columns: repeat(3, 70px);
                grid-template-rows: repeat(6, 70px);
            }
            .grid.size-18 .cell {
                width: 70px;
                height: 70px;
            }

            .cell.text-content,
            .cell[data-round-type="words"],
            .cell[data-round-type="math"],
            .cell[data-round-type="letter-word"],
            .cell[data-round-type="incomplete-word"] {
                font-size: 20px;
            }
            .cell[data-round-type="emoji"],
            .cell[data-special-type="star-placeholder"] {
                font-size: 30px;
            }
            .cell.value-revealed {
                font-size: 2.5em;
            }

            #countdownNumber {
                font-size: 1.2em;
            }
            #countdownText {
                font-size: 0.35em;
            }

            #finalWinnerModal h2 {
                font-size: 2.5em;
            }
            #finalWinnerModal p {
                font-size: 1.2em;
            }
            #finalWinnerModal button {
                padding: 12px 25px;
                font-size: 1.1em;
            }
        }
    </style>
</head>
<body>

    <div class="legal-notice">
        Ù…Ù„Ø§Ø­Ø¸Ø©: Ù‡Ø°Ù‡ Ø§Ù„Ù†Ø³Ø®Ø© Ù„Ø´Ø®Øµ ÙˆØ§Ø­Ø¯ ÙÙ‚Ø· ÙˆØªØ§Ø¨Ø¹Ø© Ù„Ù…ØªØ¬Ø± Ù‡Ù…Ø²Ø© ÙƒØ§Ù Ù„Ø°Ù„Ùƒ Ù‡ÙŠ ØºÙŠØ± Ù‚Ø§Ø¨Ù„Ø© Ù„Ù„Ù†Ø´Ø± Ø£Ùˆ Ø§Ù„Ø¨ÙŠØ¹. ÙˆÙ…Ù† ÙŠØ®Ø§Ù„Ù Ø°Ù„Ùƒ Ø³ÙŠØªÙ… Ø§ØªØ®Ø§Ø° Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ø§Ù„Ù‚Ø§Ù†ÙˆÙ†ÙŠØ© ÙÙŠ Ù‡Ø°Ø§ Ø§Ù„Ø£Ù…Ø±.
        <span>ÙˆÙ„Ù„ØªØ°ÙƒÙŠØ± Ø¨Ø°Ù…ØªÙƒ ÙˆØ£Ù…Ø§Ù†ØªÙƒ: "Ù‚Ø§Ù„ ï·º: Ù„Ø§ Ø¥ÙŠÙ…Ø§Ù† Ù„Ù…Ù† Ù„Ø§ Ø£Ù…Ø§Ù†Ø© Ù„Ù‡ØŒ ÙˆÙ„Ø§ Ø¯ÙŠÙ† Ù„Ù…Ù† Ù„Ø§ Ø¹Ù‡Ø¯ Ù„Ù‡"</span>
    </div>

    <div id="countdownOverlay" class="modal-overlay"> <div id="countdownText"></div>
        <div id="countdownNumber"></div>
    </div>

    <div id="finalWinnerModal" class="modal-overlay"> <div class="modal-content">
            <h2 id="finalWinnerText"></h2>
            <p id="finalTieText"></p>
            <div class="button-group">
                <button id="playAgainBtn">Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† ÙˆØ¨Ø¯Ø¡ Ù„Ø¹Ø¨Ø© Ø¬Ø¯ÙŠØ¯Ø©</button>
                <button id="startTieBreakerBtn" style="display: none;">Ø¨Ø¯Ø¡ Ø¬ÙˆÙ„Ø© Ø§Ù„ØªØ¹Ø§Ø¯Ù„</button>
            </div>
        </div>
    </div>

    <div class="modal-overlay" id="welcomeModal">
        <div class="modal-content">
            <h2>Ø£Ù‡Ù„Ø§Ù‹ Ø¨Ùƒ ÙÙŠ Ù„Ø¹Ø¨Ø© "ØµÙŠØ¯Ù‡Ø§"</h2>
            <img src="https://raw.githubusercontent.com/seedaha1/seedaha1/main/sedaha-removebg-preview.png" alt="Ø´Ø¹Ø§Ø± Ø§Ù„Ù„Ø¹Ø¨Ø©">
            <div class="button-group">
                <button onclick="showAdviceModal()">Ø§Ù„ØªØ§Ù„ÙŠ</button>
            </div>
        </div>
    </div>


    <div class="modal-overlay" id="adviceModal">
        <div class="modal-content">
            <h2>Ù†ØµÙŠØ­Ø© Ø¹Ù„Ø´Ø§Ù† Ù†Ù„Ø¹Ø¨ ÙˆÙ†Ø³ØªØ§Ù†Ø³â€¦ Ø¨Ø³ Ø¨Ø¯ÙˆÙ† Ù…Ø§ Ù†Ù†Ø³Ù‰ Ø§Ù„Ø£Ù‡Ù…</h2>
            <ul>
                <li>"Ø§Ù„Ù„Ø¹Ø¨ Ù…Ù…ØªØ¹ØŒ Ø¨Ø³ Ø®Ù„Ù‘Ù‡ Ø¨Ø¹Ø¯ Ø§Ù„ØµÙ„Ø§Ø©ØŒ Ø¹Ø´Ø§Ù† Ù…Ø§ ØªØ¶ÙŠØ¹ Ø¹Ù„ÙŠÙƒ ÙØ±Ø¶."</li>
                <li>"Ø§Ù„Ù„Ø¹Ø¨Ø© Ø­Ù„ÙˆØ©ØŒ Ø¨Ø³ Ø§Ù„Ù‚Ø±Ø¢Ù† Ø£Ø­Ù„Ù‰ØŒ Ø®Ø° Ù„Ùƒ ÙˆÙ‚Øª Ø¨ÙŠÙ† Ø§Ù„Ø¬ÙˆÙ„Ø§Øª ÙˆØ§Ø±ØªÙ‘Ø­ Ù…Ø¹ ÙƒÙ„Ø§Ù… Ø§Ù„Ù„Ù‡."</li>
                <li>"Ø¥Ø°Ø§ Ø¬Ø§Ø¡ ÙˆÙ‚Øª Ø§Ù„ØµÙ„Ø§Ø©ØŒ Ù†ÙˆÙ‚Ù Ø§Ù„Ù„Ø¹Ø¨ ÙˆÙ†ÙƒØ³Ø¨ Ø±Ø¶Ø§ Ø±Ø¨ Ø§Ù„Ø¹Ø§Ù„Ù…ÙŠÙ†."</li>
                <li>"Ù†Ù„Ø¹Ø¨ ÙˆÙ†Ø¶Ø­ÙƒØŒ Ù„ÙƒÙ† Ù…Ø§ Ù†Ø®Ù„ÙŠ Ø§Ù„Ù„Ø¹Ø¨ ÙŠÙ„Ù‡ÙŠÙ†Ø§ Ø¹Ù† Ø·Ø§Ø¹Ø© Ø§Ù„Ù„Ù‡."</li>
                <li>"Ø§Ù„Ù„Ø¹Ø¨Ø© Ø¬Ø²Ø¡ Ù…Ù† ÙŠÙˆÙ…Ù†Ø§ØŒ Ù…Ùˆ ÙƒÙ„ ÙŠÙˆÙ…Ù†Ø§â€¦ Ù„Ø§ ØªÙ†Ø³Ù‰ Ø£Ù‡Ø¯Ø§ÙÙƒ ÙˆØ·Ù…ÙˆØ­Ø§ØªÙƒ."</li>
                <li>"Ø§Ù„Ù„Ø¹Ø¨Ø© Ù…Ø§ ØªÙ…Ù†Ø¹ Ø¥Ù†Ùƒ ØªØ°Ø§ÙƒØ±ØŒ Ù†Ø¸Ù‘Ù… ÙˆÙ‚ØªÙƒ ÙˆØ®Ù„Ù‘ Ø§Ù„Ù„Ø¹Ø¨ Ù…ÙƒØ§ÙØ£Ø© Ø¨Ø¹Ø¯ Ø§Ù„Ø¥Ù†Ø¬Ø§Ø²."</li>
                <li>"ÙˆÙ‚Øª Ø§Ù„Ù…Ø°Ø§ÙƒØ±Ø© ØºØ§Ù„ÙŠØŒ Ù„Ø§ ØªØ®Ù„ÙŠÙ‡ ÙŠØ¶ÙŠØ¹ Ø¹Ù„Ù‰ Ø­Ø³Ø§Ø¨ Ø¬ÙŠÙ… Ù…Ù…ÙƒÙ† ØªÙ„Ø¹Ø¨Ù‡ Ø¨Ø£ÙŠ ÙˆÙ‚Øª."</li>
            </ul>
            <p>"Ø¥Ø°Ø§ Ù„Ø¹Ø¨Øª ÙˆØ£Ù†Øª Ù…Ø­Ø§ÙØ¸ Ø¹Ù„Ù‰ ØµÙ„Ø§ØªÙƒ ÙˆØ£Ø°ÙƒØ§Ø±Ùƒ ÙˆÙ‚Ø±Ø§Ø¡Ø© Ø§Ù„Ù‚Ø±Ø¢Ù† ÙˆØ®Ù„ØµØª Ø§Ù„Ù…Ø°Ø§ÙƒØ±Ø© ÙˆØ§Ù„Ø£Ø´ØºØ§Ù„ Ø§Ù„Ù„ÙŠ Ø¹Ù„ÙŠÙƒâ€¦ Ø£Ù†Øª ÙƒØ³Ø¨Øª Ø§Ù„Ø¯Ù†ÙŠØ§ ÙˆØ§Ù„Ø¢Ø®Ø±Ø© Ø¨Ø¥Ø°Ù† Ø§Ù„Ù„Ù‡"</p>
            <div class="button-group">
                <button onclick="showInstructionsModal()">Ø§Ù„ØªØ§Ù„ÙŠ</button>
            </div>
        </div>
    </div>

    <div class="modal-overlay" id="instructionsModal">
        <div class="modal-content">
            <h2>ğŸ“ ØªØ¹Ù„ÙŠÙ…Ø§Øª Ù„Ø¹Ø¨Ø© ØµÙŠØ¯Ù‡Ø§ ğŸ®</h2>
            <ul>
                <li>ğŸŒŸ **Ø§Ù„Ù‡Ø¯Ù:** Ù…Ø·Ø§Ø¨Ù‚Ø© Ø§Ù„Ø±Ù…ÙˆØ² Ø£Ùˆ Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ø£Ùˆ Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª Ø§Ù„Ø­Ø³Ø§Ø¨ÙŠØ© Ø§Ù„Ù…ØªØ´Ø§Ø¨Ù‡Ø© ÙÙŠ Ø®Ù„Ø§ÙŠØ§ Ø§Ù„Ø´Ø¨ÙƒØ©.</li>
                <li>1ï¸âƒ£ **Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„ÙØ¦Ø©:** (Ù…Ù„Ø§Ø­Ø¸Ø©: ÙŠØªÙ… Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„ÙØ¦Ø© ØªÙ„Ù‚Ø§Ø¦ÙŠÙ‹Ø§ Ø¨Ø§Ù„ØªØ±ØªÙŠØ¨ ÙÙŠ Ù‡Ø°Ù‡ Ø§Ù„Ù„Ø¹Ø¨Ø©).</li>
                <li>2ï¸âƒ£ **Ø¨Ø¯Ø¡ Ø§Ù„Ø¬ÙˆÙ„Ø©:** Ø§Ø¶ØºØ· Ø²Ø± **Ø¨Ø¯Ø¡ Ø§Ù„Ø¬ÙˆÙ„Ø©** Ù„Ø¹Ø±Ø¶ Ø§Ù„Ø±Ù…ÙˆØ² Ø¹Ù„Ù‰ Ø§Ù„Ø´Ø¨ÙƒØ© Ù„Ù…Ø¯Ø© Ù…Ø­Ø¯Ø¯Ø© â³ Ù…Ø¹ Ø¹Ø¯Ø§Ø¯ ÙŠØ¸Ù‡Ø± Ø§Ù„ÙˆÙ‚Øª. Ø®Ù„Ø§Ù„ Ù‡Ø°Ù‡ Ø§Ù„ÙØªØ±Ø©ØŒ Ø­Ø§ÙˆÙ„ ØªØ°ÙƒØ± Ø£Ù…Ø§ÙƒÙ† Ø§Ù„Ø±Ù…ÙˆØ².</li>
                <li>3ï¸âƒ£ **Ù…Ø·Ø§Ø¨Ù‚Ø© Ø§Ù„Ø±Ù…ÙˆØ²:** Ø¨Ø¹Ø¯ Ø§Ù†ØªÙ‡Ø§Ø¡ Ø§Ù„ÙˆÙ‚Øª â°ØŒ ØªØ¹ÙˆØ¯ Ø§Ù„Ø®Ù„Ø§ÙŠØ§ Ù„Ø£Ø±Ù‚Ø§Ù… ÙÙ‚Ø·ØŒ Ø§Ø¨Ø¯Ø£ Ø¨Ø§Ù„Ù†Ù‚Ø± Ø¹Ù„Ù‰ Ø®Ù„ÙŠØªÙŠÙ†:
                    <ul>
                        <li>âœ… Ø¥Ø°Ø§ ØªØ·Ø§Ø¨Ù‚ Ø§Ù„Ø±Ù…Ø²Ø§Ù†ØŒ ÙŠÙƒØ³Ø¨ Ø§Ù„ÙØ±ÙŠÙ‚ Ø£Ùˆ Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ† Ù†Ù‚Ø·Ø© Ø¹Ù„Ù‰ ÙƒÙ„ ØªØ·Ø§Ø¨Ù‚ ØµØ­ÙŠØ­.</li>
                        <li>âŒ Ø¥Ø°Ø§ Ù„Ù… ØªØªØ·Ø§Ø¨Ù‚ØŒ Ù„Ø§ ÙŠÙƒØ³Ø¨ Ø£ÙŠ Ù†Ù‚Ø·Ø©.</li>
                    </ul>
                </li>
                <li>4ï¸âƒ£ **Ø¨Ø·Ø§Ù‚Ø© Ø§Ù„Ù†Ø¬Ù…Ø© â­:** Ø¥Ø°Ø§ ÙƒØ´ÙØª Ø¨Ø·Ø§Ù‚Ø© **Ø§Ù„Ù†Ø¬Ù…Ø© â­**ØŒ Ø³ÙŠØªÙ… Ø¥Ø¶Ø§ÙØ© Ø£Ùˆ Ø®ØµÙ… Ù†Ù‚Ø§Ø· Ù…Ù† Ø±ØµÙŠØ¯ ÙØ±ÙŠÙ‚Ùƒ! (ØªØªØºÙŠØ± Ù‚ÙŠÙ…ØªÙ‡Ø§ Ø¹Ø´ÙˆØ§Ø¦ÙŠØ§Ù‹ Ø¨ÙŠÙ† Ø³Ø§Ù„Ø¨ ÙˆÙ…ÙˆØ¬Ø¨ ÙˆØªØ²ÙŠØ¯ Ù…Ø¹ ÙƒÙ„ Ù…Ø¬Ù…ÙˆØ¹Ø© Ø¬ÙˆÙ„Ø§ØªØŒ ÙˆÙŠÙ…ÙƒÙ† Ø¥Ø¹Ø§Ø¯Ø© ÙØªØ­Ù‡Ø§!).</li>
                <li>5ï¸âƒ£ **Ø§Ù†ØªÙ‡Ø§Ø¡ Ø§Ù„Ø¬ÙˆÙ„Ø©:** Ø¹Ù†Ø¯ Ø§Ù„ÙƒØ´Ù Ø¹Ù† ÙƒÙ„ **Ø£Ø²ÙˆØ§Ø¬ Ø§Ù„Ø±Ù…ÙˆØ² Ø§Ù„Ø¹Ø§Ø¯ÙŠØ©**ØŒ Ø³ØªÙƒÙˆÙ† Ø§Ù„Ø¬ÙˆÙ„Ø© Ù‚Ø¯ Ø§Ù†ØªÙ‡Øª. Ø§Ù„Ù„Ø¹Ø¨Ø© Ø³ØªÙ†ØªÙ‚Ù„ ØªÙ„Ù‚Ø§Ø¦ÙŠÙ‹Ø§ Ø¥Ù„Ù‰ Ø§Ù„Ø¬ÙˆÙ„Ø© Ø§Ù„ØªØ§Ù„ÙŠØ© Ø¯Ø§Ø®Ù„ Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø©.</li>
                <li>6ï¸âƒ£ **Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ù„Ù„Ù…Ø¬Ù…ÙˆØ¹Ø© Ø§Ù„ØªØ§Ù„ÙŠØ©:** Ø¨Ø¹Ø¯ Ø§Ù†ØªÙ‡Ø§Ø¡ Ø¬Ù…ÙŠØ¹ Ø¬ÙˆÙ„Ø§Øª Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø©ØŒ Ø³ÙŠØ¸Ù‡Ø± Ø²Ø± **"Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø© Ø§Ù„ØªØ§Ù„ÙŠØ©"** Ù„Ù„Ø§Ù†ØªÙ‚Ø§Ù„ ÙŠØ¯ÙˆÙŠÙ‹Ø§.</li>
                <li>ğŸ”„ **Ø²Ø± Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ†:** ÙŠØ¹ÙŠØ¯ Ø§Ù„Ù„Ø¹Ø¨Ø© Ù„Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ø§Ø¨ØªØ¯Ø§Ø¦ÙŠØ© Ù„ØªØ®ØªØ§Ø± Ø¹Ø¯Ø¯ Ø§Ù„ÙØ±Ù‚ Ø£Ùˆ ØªØ¹ÙŠØ¯ Ø§Ù„Ø¬ÙˆÙ„Ø©.</li>
            </ul>
            <div class="button-group">
                <button onclick="hideInstructionsAndShowTeamSelection()">Ø¨Ø¯Ø¡ Ø§Ù„Ù„Ø¹Ø¨Ø©</button>
            </div>
        </div>
    </div>

    <div class="modal-overlay" id="teamSelectionModal">
        <div class="modal-content">
            <h2>Ø§Ø®ØªØ± Ø¹Ø¯Ø¯ Ø§Ù„ÙØ±Ù‚</h2>
            <div class="team-options">
                <button onclick="selectTeams(2)">2 ÙØ±Ù‚</button>
                <button onclick="selectTeams(3)">3 ÙØ±Ù‚</button>
                <button onclick="selectTeams(4)">4 ÙØ±Ù‚</button>
            </div>
        </div>
    </div>

    <div class="modal-overlay" id="teamNameInputModal">
        <div class="modal-content">
            <h2>Ø³Ù…Ù‘Ù Ø§Ù„ÙØ±Ù‚</h2>
            <div class="team-name-inputs" id="teamNameInputsContainer"> </div>
            <div class="button-group">
                <button onclick="confirmTeamNames()">ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø£Ø³Ù…Ø§Ø¡</button>
            </div>
        </div>
    </div>

    <div class="modal-overlay" id="resetConfirmationModal">
        <div class="modal-content">
            <h2>Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ØŸ</h2>
            <p>Ù‡Ù„ ØªØ±ÙŠØ¯ Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ù„Ø¹Ø¨Ø© ÙˆØ¨Ø¯Ø¡ Ù…Ù† Ø¬Ø¯ÙŠØ¯ØŸ Ø³ØªÙÙ‚Ø¯ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù†Ù‚Ø§Ø· Ø§Ù„Ø­Ø§Ù„ÙŠØ©.</p>
            <div class="button-group">
                <button id="confirmResetBtn">ØªØ£ÙƒÙŠØ¯</button>
                <button id="cancelResetBtn">Ø¥Ù„ØºØ§Ø¡</button>
            </div>
        </div>
    </div>

    <div class="game-area">
        <div class="scoreboard" id="scoreboard"> </div>
        <div class="result" id="result"></div>
        <div class="timer" id="timerContainer"></div>
        <div class="grid" id="grid"></div>
        <div class="controls">
            <button onclick="handleStartOrNextRound()" id="startGameBtn">Ø¨Ø¯Ø¡ Ø§Ù„Ø¬ÙˆÙ„Ø©</button>
            <button onclick="nextGroupManually()" id="nextGroupBtn" style="display: none;">Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø© Ø§Ù„ØªØ§Ù„ÙŠØ©</button>
            <button onclick="showResetConfirmation()" id="resetGameBtn">Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ†</button>
        </div>
    </div>

    <script>
        // ØªØ¹Ø±ÙŠÙ ÙØ¦Ø§Øª Ø§Ù„Ø¬ÙˆÙ„Ø§Øª
        const roundCategories = [
            "ÙÙˆØ§ÙƒÙ‡", "Ø®Ø¶Ø±ÙˆØ§Øª", "Ø§Ù„Ø£Ø¯ÙˆØ§Øª", "Ø§Ù„Ù…Ø±ÙƒØ¨Ø§Øª",
            "Ø§Ù„Ø­Ø±Ù ÙˆØ§Ù„ÙƒÙ„Ù…Ø©", "Ø£ÙƒÙ…Ù„ Ø§Ù„ÙƒÙ„Ù…Ø©", "Ù…Ø±Ø§Ø¯Ù Ø§Ù„ÙƒÙ„Ù…Ø©", "Ø§Ù„ÙƒÙ„Ù…Ø© ÙˆØ¹ÙƒØ³Ù‡Ø§",
            "Ø¹Ù…Ù„ÙŠØ© Ø¬Ù…Ø¹", "Ø¹Ù…Ù„ÙŠØ© Ø·Ø±Ø­", "Ø¹Ù…Ù„ÙŠØ© Ø¶Ø±Ø¨", "Ø¹Ù…Ù„ÙŠØ© Ù‚Ø³Ù…Ø©"
        ];
        // Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø© Ø§Ù„Ø£ÙˆÙ„Ù‰
        const group1Rounds = [
            { emojis: ["ğŸ", "ğŸŒ", "ğŸ‡", "ğŸŠ", "ğŸ“", "ğŸ", "ğŸ¥­", "ğŸ¥"], gridSizeClass: "size-14", timer: 10, category: roundCategories[0], specialSquaresCount: 2, totalEmojiPairs: 7, type: "emoji" },
            { emojis: ["ğŸ¥•", "ğŸ¥”", "ğŸ§…", "ğŸ¥¦", "ğŸ¥’", "ğŸŒ¶ï¸", "ğŸ†", "ğŸŒ½"], gridSizeClass: "size-14", timer: 10, category: roundCategories[1], specialSquaresCount: 2, totalEmojiPairs: 7, type: "emoji" },
            { emojis: ["ğŸ”¨", "ğŸ”§", "ğŸ’¡", "âœ‚ï¸", "ğŸ“Œ", "ğŸ”‘", "ğŸ”‹", "ğŸ“±"], gridSizeClass: "size-14", timer: 5, category: roundCategories[2], specialSquaresCount: 2, totalEmojiPairs: 7, type: "emoji" },
            { emojis: ["ğŸš—", "ğŸšŒ", "ğŸš²", "ğŸš†", "ğŸš", "ğŸš¤", "ğŸ›µ", "ğŸš¢"], gridSizeClass: "size-14", timer: 5, category: roundCategories[3], specialSquaresCount: 2, totalEmojiPairs: 7, type: "emoji" }
        ];
        // Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø© Ø§Ù„Ø«Ø§Ù†ÙŠØ©
        const group2Rounds = [
            { letterWordPairs: [["Ø£", "Ø£Ø³Ø¯"], ["Ø¨", "Ø¨Ù‚Ø±Ø©"], ["Øª", "ØªÙ…Ø³Ø§Ø­"], ["Ø¬", "Ø¬Ù…Ù„"], ["Ø­", "Ø­ØµØ§Ù†"], ["Ø¯", "Ø¯Ø¨"], ["Ø²", "Ø²Ø±Ø§ÙØ©"]], gridSizeClass: "size-16", timer: 10, category: roundCategories[4], specialSquaresCount: 2, totalEmojiPairs: 7, type: "letter-word" },
            { incompleteWordPairs: [["ÙƒØªØ§Ø¨", "ÙƒØª_Ø¨", "Ø§"], ["Ù‚Ù„Ù…", "Ù‚_Ù…", "Ù„"], ["Ø´Ù…Ø³", "Ø´_Ø³", "Ù…"], ["Ù‚Ù…Ø±", "Ù‚_Ø±", "Ù…"], ["Ø¨Ø­Ø±", "Ø¨_Ø±", "Ø­"], ["ÙˆØ±Ø¯Ø©", "ÙˆØ±_Ø©", "Ø¯"], ["ØªÙØ§Ø­", "Øª_Ø§Ø­", "Ù"]], gridSizeClass: "size-16", timer: 10, category: roundCategories[5], specialSquaresCount: 2, totalEmojiPairs: 7, type: "incomplete-word" },
            { textPairs: [["Ø³Ø¹ÙŠØ¯", "ÙØ±Ø­"], ["ÙƒØ¨ÙŠØ±", "Ø¶Ø®Ù…"], ["ØµØºÙŠØ±", "Ø¶Ø¦ÙŠÙ„"], ["Ø³Ø±ÙŠØ¹", "Ø¹Ø§Ø¬Ù„"], ["Ø¨Ø·ÙŠØ¡", "Ù…ØªØ¨Ø§Ø·Ø¦"], ["Ø¬Ù…ÙŠÙ„", "Ø­Ù„Ùˆ"], ["Ø°ÙƒÙŠ", "Ø¹Ø¨Ù‚Ø±ÙŠ"]], gridSizeClass: "size-16", timer: 5, category: roundCategories[6], specialSquaresCount: 2, totalEmojiPairs: 7, type: "words" },
            { textPairs: [["ØµØºÙŠØ±", "ÙƒØ¨ÙŠØ±"], ["Ù‚Ø±ÙŠØ¨", "Ø¨Ø¹ÙŠØ¯"], ["Ø·ÙˆÙŠÙ„", "Ù‚ØµÙŠØ±"], ["Ø­Ø§Ø±", "Ø¨Ø§Ø±Ø¯"], ["Ù„ÙŠÙ„", "Ù†Ù‡Ø§Ø±"], ["ØµØ¹ÙˆØ¯", "Ù‡Ø¨ÙˆØ·"], ["Ø¯Ø§Ø®Ù„", "Ø®Ø§Ø±Ø¬"]], gridSizeClass: "size-16", timer: 5, category: roundCategories[7], specialSquaresCount: 2, totalEmojiPairs: 7, type: "words" }
        ];
        // Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø© Ø§Ù„Ø«Ø§Ù„Ø«Ø© (Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª Ø§Ù„Ø­Ø³Ø§Ø¨ÙŠØ©)
        const group3Rounds = [
            { mathPairs: [["2+3", "5"], ["5+4", "9"], ["10+2", "12"], ["7+1", "8"], ["6+6", "12"], ["9+3", "12"], ["4+7", "11"]], gridSizeClass: "size-18", timer: 15, category: roundCategories[8], specialSquaresCount: 2, totalEmojiPairs: 7, type: "math" },
            { mathPairs: [["8-2", "6"], ["7-3", "4"], ["10-5", "5"], ["9-1", "8"], ["12-4", "8"], ["11-6", "5"], ["15-7", "8"]], gridSizeClass: "size-18", timer: 15, category: roundCategories[9], specialSquaresCount: 2, totalEmojiPairs: 7, type: "math" },
            { mathPairs: [["2*3", "6"], ["4*2", "8"], ["5*5", "25"], ["3*7", "21"], ["6*4", "24"], ["8*3", "24"], ["7*5", "35"]], gridSizeClass: "size-18", timer: 15, category: roundCategories[10], specialSquaresCount: 2, totalEmojiPairs: 7, type: "math" },
            { mathPairs: [["10/2", "5"], ["12/3", "4"], ["15/5", "3"], ["18/6", "3"], ["20/4", "5"], ["24/8", "3"], ["28/7", "4"]], gridSizeClass: "size-18", timer: 15, category: roundCategories[11], specialSquaresCount: 2, totalEmojiPairs: 7, type: "math" }
        ];

        let allGameRounds = [group1Rounds, group2Rounds, group3Rounds];
        // Ø¨ÙŠØ§Ù†Ø§Øª Ø¬ÙˆÙ„Ø© Ø§Ù„ØªØ¹Ø§Ø¯Ù„
        const tieBreakerEmojis = [
            "505", "515", "525", "535", "545", "555", "575"
        ];
        const tieBreakerTimer = 5;
        const tieBreakerSpecialSquaresCount = 1;
        const tieBreakerFixedValue = 4;
        const tieBreakerTotalEmojiPairs = 7;
        const interRoundDelay = 10;
        let teamNames = {
            "blue": "Ø§Ù„ÙØ±ÙŠÙ‚ Ø§Ù„Ø£Ø²Ø±Ù‚",
            "red": "Ø§Ù„ÙØ±ÙŠÙ‚ Ø§Ù„Ø£Ø­Ù…Ø±",
            "green": "Ø§Ù„ÙØ±ÙŠÙ‚ Ø§Ù„Ø£Ø®Ø¶Ø±",
            "orange": "Ø§Ù„ÙØ±ÙŠÙ‚ Ø§Ù„Ø¨Ø±ØªÙ‚Ø§Ù„ÙŠ"
        };
        const teamColors = ["blue", "red", "green", "orange"];
        const teamCssColors = {
            "blue": "#004085",
            "red": "#721c24",
            "green": "#155724",
            "orange": "#856404"
        };
        let activeTeams = [];
        let currentTeamIndex = 0;
        let startingTeamIndexForRound = 0;
        let currentGroupIndex = 0;
        let roundIndex = 0;
        let board = [];
        let firstPick = null;
        let lockBoard = false;
        let scores = {};
        let matchedPairsCount = 0;
        let timerInterval = null;
        let isTieBreakerRound = false;
        let gameInitialized = false;
        let isTransitioning = false;
        const welcomeModal = document.getElementById("welcomeModal");
        const adviceModal = document.getElementById("adviceModal");
        const instructionsModal = document.getElementById("instructionsModal");
        const teamSelectionModal = document.getElementById("teamSelectionModal");
        const teamNameInputModal = document.getElementById("teamNameInputModal");
        const teamNameInputsContainer = document.getElementById("teamNameInputsContainer");
        const gameArea = document.querySelector(".game-area");
        const grid = document.getElementById("grid");
        const timerContainer = document.getElementById("timerContainer");
        const resultDisplay = document.getElementById("result");
        const startGameBtn = document.getElementById("startGameBtn");
        const nextGroupBtn = document.getElementById("nextGroupBtn");
        const resetGameBtn = document.getElementById("resetGameBtn");
        const scoreboardDiv = document.getElementById("scoreboard");
        let scoreBoardElements = {};
        const countdownOverlay = document.getElementById("countdownOverlay");
        const countdownText = document.getElementById("countdownText");
        const countdownNumber = document.getElementById("countdownNumber");
        const finalWinnerModal = document.getElementById("finalWinnerModal");
        const finalWinnerText = document.getElementById("finalWinnerText");
        const finalTieText = document.getElementById("finalTieText");
        const playAgainBtn = document.getElementById("playAgainBtn");
        const startTieBreakerBtn = document.getElementById("startTieBreakerBtn");
        const resetConfirmationModal = document.getElementById("resetConfirmationModal");
        const confirmResetBtn = document.getElementById("confirmResetBtn");
        const cancelResetBtn = document.getElementById("cancelResetBtn");

        // ... Ø¨Ù‚ÙŠØ© ÙƒÙˆØ¯ JavaScript ...
        function shuffle(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
        }

        // Functions for Modals
        function showModal(modalElement) {
            // Hide all other modals
            document.querySelectorAll('.modal-overlay').forEach(modal => {
                if (modal !== modalElement) {
                    modal.classList.remove('show');
                }
            });
            modalElement.classList.add('show');
        }

        function hideAllModals() {
            document.querySelectorAll('.modal-overlay').forEach(modal => {
                modal.classList.remove('show');
            });
        }

        function showAdviceModal() {
            showModal(adviceModal);
        }
        
        function showInstructionsModal() {
            showModal(instructionsModal);
        }

        function hideInstructionsAndShowTeamSelection() {
            showModal(teamSelectionModal);
        }

        function showResetConfirmation() {
            showModal(resetConfirmationModal);
        }
        
        function hideResetConfirmation() {
            hideAllModals();
            if (!gameInitialized) {
                showModal(welcomeModal); // Go back to the welcome modal if the game hasn't started
            }
        }

        function selectTeams(numTeams) {
            activeTeams = teamColors.slice(0, numTeams);
            teamNameInputsContainer.innerHTML = '';
            activeTeams.forEach((color, index) => {
                const teamDiv = document.createElement('div');
                const label = document.createElement('label');
                label.textContent = `Ø§Ø³Ù… Ø§Ù„ÙØ±ÙŠÙ‚ ${index + 1}:`;
                label.style.color = teamCssColors[color];
                const input = document.createElement('input');
                input.type = 'text';
                input.value = teamNames[color];
                input.dataset.color = color;
                input.oninput = function() { teamNames[color] = this.value; };
                teamDiv.appendChild(label);
                teamDiv.appendChild(input);
                teamNameInputsContainer.appendChild(teamDiv);
            });
            showModal(teamNameInputModal);
        }

        function confirmTeamNames() {
            // Update the global teamNames object with new values from inputs
            document.querySelectorAll('#teamNameInputsContainer input').forEach(input => {
                const color = input.dataset.color;
                teamNames[color] = input.value || teamNames[color];
            });
            hideAllModals();
            setupGame();
            startGameBtn.style.display = 'block';
            nextGroupBtn.style.display = 'none';
        }

        function setupGame() {
            scores = {};
            activeTeams.forEach(color => {
                scores[color] = 0;
            });
            gameInitialized = true;
            currentGroupIndex = 0;
            roundIndex = 0;
            startingTeamIndexForRound = 0;
            updateScoreboard();
            handleStartOrNextRound();
        }

        function createScoreboard() {
            scoreboardDiv.innerHTML = '';
            scoreBoardElements = {};
            activeTeams.forEach(color => {
                const teamDiv = document.createElement('div');
                teamDiv.classList.add('team', color);
                teamDiv.innerHTML = `<span>${teamNames[color]}</span><span class="score">${scores[color]}</span>`;
                scoreboardDiv.appendChild(teamDiv);
                scoreBoardElements[color] = teamDiv;
            });
            updateScoreboard();
        }
        
        function updateScoreboard() {
            if (activeTeams.length > 0) {
                activeTeams.forEach(color => {
                    const teamElement = scoreBoardElements[color];
                    if (teamElement) {
                        teamElement.querySelector('.score').textContent = scores[color];
                        teamElement.classList.remove('active');
                    }
                });
                const activeTeamColor = activeTeams[currentTeamIndex];
                if (scoreBoardElements[activeTeamColor]) {
                    scoreBoardElements[activeTeamColor].classList.add('active');
                }
            }
        }

        function handleStartOrNextRound() {
            if (isTransitioning) return;
            isTransitioning = true;
            startGameBtn.disabled = true;
            nextGroupBtn.disabled = true;
            resetGameBtn.disabled = true;

            hideAllModals();

            // Hide the game area while transitioning
            gameArea.style.display = 'none';

            if (currentGroupIndex < allGameRounds.length) {
                const roundCategory = allGameRounds[currentGroupIndex][roundIndex].category;
                startCountdown(`Ø³ØªØ¨Ø¯Ø£ Ø¬ÙˆÙ„Ø©: ${roundCategory}`, 3, startRound);
            } else {
                endGame();
            }
        }

        function startCountdown(text, duration, callback) {
            countdownOverlay.classList.add('show');
            countdownText.textContent = text;
            let currentNumber = duration;
            countdownNumber.textContent = currentNumber;

            const countdownInterval = setInterval(() => {
                currentNumber--;
                if (currentNumber > 0) {
                    countdownNumber.textContent = currentNumber;
                } else {
                    clearInterval(countdownInterval);
                    countdownOverlay.classList.remove('show');
                    callback();
                }
            }, 1000);
        }

        function startRound() {
            gameArea.style.display = 'flex';
            resultDisplay.textContent = '';
            if (isTieBreakerRound) {
                createTieBreakerBoard();
            } else {
                createBoard();
            }
            // Set starting team for the new round
            currentTeamIndex = startingTeamIndexForRound;
            updateScoreboard();
            setTimeout(() => {
                isTransitioning = false;
                startGameBtn.disabled = false;
                nextGroupBtn.disabled = false;
                resetGameBtn.disabled = false;
            }, 1000); // 1 second buffer after countdown
        }

        function createBoard() {
            lockBoard = true;
            firstPick = null;
            let currentRound = allGameRounds[currentGroupIndex][roundIndex];
            grid.className = 'grid ' + currentRound.gridSizeClass;
            grid.innerHTML = '';
            board = [];
            matchedPairsCount = 0;
            
            let pairs;
            if (currentRound.type === "emoji") {
                pairs = [...currentRound.emojis, ...currentRound.emojis];
            } else if (currentRound.type === "letter-word") {
                pairs = currentRound.letterWordPairs.flatMap(p => p);
            } else if (currentRound.type === "incomplete-word") {
                pairs = currentRound.incompleteWordPairs.flatMap(p => [p[1], p[2]]);
            } else if (currentRound.type === "words") {
                pairs = currentRound.textPairs.flatMap(p => p);
            } else if (currentRound.type === "math") {
                pairs = currentRound.mathPairs.flatMap(p => p);
            }
            
            shuffle(pairs);
            
            // Add special squares
            let specialPairs = [];
            for (let i = 0; i < currentRound.specialSquaresCount; i++) {
                let value = Math.random() < 0.5 ? 1 : -1;
                specialPairs.push({ type: 'special', value: value });
                specialPairs.push({ type: 'special', value: value });
            }
            shuffle(specialPairs);
            
            // Generate board array
            for (let i = 0; i < currentRound.totalEmojiPairs * 2; i++) {
                let cellData = { content: pairs[i], type: currentRound.type, isSpecial: false };
                board.push(cellData);
            }

            // Insert special squares
            for (let i = 0; i < specialPairs.length; i++) {
                let randomIndex = Math.floor(Math.random() * board.length);
                board.splice(randomIndex, 0, { content: 'â­', type: 'special', isSpecial: true, value: specialPairs[i].value });
            }

            // Handle empty cells if grid size is not exactly filled
            const totalCells = parseInt(currentRound.gridSizeClass.split('-')[1]);
            const cellsToFill = currentRound.totalEmojiPairs * 2 + specialPairs.length;
            if (cellsToFill < totalCells) {
                const emptyCellsCount = totalCells - cellsToFill;
                for (let i = 0; i < emptyCellsCount; i++) {
                    board.push({ content: '', type: 'empty', isSpecial: false });
                }
                shuffle(board); // Shuffle again to mix in empty cells
            }

            // Create DOM elements for the board
            board.forEach((cellData, index) => {
                const cell = document.createElement('div');
                cell.classList.add('cell', 'hidden', 'text-content');
                if (cellData.type === 'empty') {
                    cell.classList.add('empty');
                    cell.innerHTML = '';
                } else {
                    cell.dataset.content = cellData.content;
                    cell.dataset.isSpecial = cellData.isSpecial;
                    cell.dataset.type = cellData.type;
                    if (cellData.isSpecial) {
                        cell.dataset.value = cellData.value;
                        cell.dataset.specialType = 'star-placeholder';
                    } else {
                        // If it's not a special cell, make sure to set content
                        cell.innerHTML = `<span>${cellData.content}</span>`;
                    }
                    cell.addEventListener('click', () => flipCard(cell, cellData));
                }
                grid.appendChild(cell);
            });
            
            // Show all cards for a few seconds at the start
            const timerSeconds = currentRound.timer;
            showAllCards(timerSeconds);
        }
        
        function showAllCards(seconds) {
            grid.querySelectorAll('.cell:not(.empty)').forEach(cell => {
                cell.classList.remove('hidden');
            });
            let timer = seconds;
            timerContainer.textContent = `Ù…ØªØ¨Ù‚ÙŠ Ù…Ù† Ø§Ù„ÙˆÙ‚Øª: ${timer} Ø«ÙˆØ§Ù†ÙŠ`;
            timerInterval = setInterval(() => {
                timer--;
                timerContainer.textContent = `Ù…ØªØ¨Ù‚ÙŠ Ù…Ù† Ø§Ù„ÙˆÙ‚Øª: ${timer} Ø«ÙˆØ§Ù†ÙŠ`;
                if (timer <= 0) {
                    clearInterval(timerInterval);
                    timerContainer.textContent = `Ø§Ù„ÙˆÙ‚Øª Ø§Ù†ØªÙ‡Ù‰!`;
                    hideAllCards();
                }
            }, 1000);
        }

        function hideAllCards() {
            grid.querySelectorAll('.cell:not(.empty)').forEach(cell => {
                cell.classList.add('hidden');
            });
            lockBoard = false;
        }

        function flipCard(cell, cellData) {
            if (lockBoard || cell.classList.contains('matched') || cell === firstPick) return;

            cell.classList.remove('hidden');

            if (cellData.isSpecial) {
                handleSpecialCard(cell, cellData);
                return;
            }

            if (!firstPick) {
                firstPick = cell;
                firstPick.classList.add('revealed');
                return;
            }

            lockBoard = true;
            let secondPick = cell;
            secondPick.classList.add('revealed');

            turns++;
            updateUI();

            setTimeout(() => {
                checkForMatch(firstPick, secondPick);
            }, 1000);
        }
        
        function handleSpecialCard(cell, cellData) {
            scores[activeTeams[currentTeamIndex]] += cellData.value;
            cell.classList.add('value-revealed', cellData.value > 0 ? 'positive' : 'negative');
            cell.innerHTML = `<span>${cellData.value > 0 ? '+' : ''}${cellData.value}</span>`;
            cell.removeEventListener('click', flipCard);
            updateScoreboard();
            
            lockBoard = true;
            setTimeout(() => {
                cell.classList.remove('value-revealed', 'positive', 'negative');
                cell.classList.add('hidden');
                cell.innerHTML = `<span>â­</span>`;
                lockBoard = false;
            }, 1500); // 1.5 seconds to show the value
        }

        function checkForMatch(card1, card2) {
            let isMatch = card1.dataset.content === card2.dataset.content;
            
            if (isMatch) {
                disableCards(card1, card2);
            } else {
                unflipCards(card1, card2);
            }
        }

        function disableCards(card1, card2) {
            card1.removeEventListener('click', () => flipCard(card1, board.find(c => c.content === card1.dataset.content)));
            card2.removeEventListener('click', () => flipCard(card2, board.find(c => c.content === card2.dataset.content)));
            card1.classList.remove('revealed');
            card2.classList.remove('revealed');
            card1.classList.add('matched');
            card2.classList.add('matched');
            
            scores[activeTeams[currentTeamIndex]] += 10;
            matchedPairsCount++;

            updateScoreboard();
            resetBoard();
            checkRoundEnd();
        }

        function unflipCards(card1, card2) {
            card1.classList.remove('revealed');
            card2.classList.remove('revealed');
            card1.classList.add('hidden');
            card2.classList.add('hidden');
            
            scores[activeTeams[currentTeamIndex]] = Math.max(0, scores[activeTeams[currentTeamIndex]] - 5);
            
            updateScoreboard();
            changeTurn();
            resetBoard();
        }

        function resetBoard() {
            [firstPick, lockBoard] = [null, false];
        }

        function changeTurn() {
            currentTeamIndex = (currentTeamIndex + 1) % activeTeams.length;
            updateScoreboard();
        }
        
        function checkRoundEnd() {
            const currentRound = allGameRounds[currentGroupIndex][roundIndex];
            if (matchedPairsCount === currentRound.totalEmojiPairs) {
                // Round is over
                resultDisplay.textContent = `Ø§Ù†ØªÙ‡Øª Ø¬ÙˆÙ„Ø© ${currentRound.category}!`;
                setTimeout(() => {
                    nextRound();
                }, 2000);
            }
        }

        function nextRound() {
            roundIndex++;
            if (roundIndex < allGameRounds[currentGroupIndex].length) {
                // If there are more rounds in the current group
                startingTeamIndexForRound = currentTeamIndex; // The next round starts with the current team
                handleStartOrNextRound();
            } else {
                // If all rounds in the current group are done
                roundIndex = 0; // Reset round index for next group
                currentGroupIndex++;
                if (currentGroupIndex < allGameRounds.length) {
                    // Show a button to manually go to the next group
                    gameArea.style.display = 'none';
                    resultDisplay.textContent = `Ø§Ù†ØªÙ‡Øª Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø© ${currentGroupIndex}!`;
                    nextGroupBtn.style.display = 'block';
                    startGameBtn.style.display = 'none';
                    resetGameBtn.disabled = false;
                } else {
                    // Game is over
                    endGame();
                }
            }
        }
        
        function nextGroupManually() {
            nextGroupBtn.style.display = 'none';
            startGameBtn.style.display = 'block';
            handleStartOrNextRound();
        }

        function endGame() {
            let maxScore = -1;
            let winners = [];
            activeTeams.forEach(color => {
                if (scores[color] > maxScore) {
                    maxScore = scores[color];
                    winners = [color];
                } else if (scores[color] === maxScore) {
                    winners.push(color);
                }
            });

            if (winners.length === 1) {
                const winnerColor = winners[0];
                finalWinnerText.textContent = `Ù…Ø¨Ø±ÙˆÙƒ! Ø§Ù„ÙØ§Ø¦Ø² Ù‡Ùˆ ${teamNames[winnerColor]}!`;
                finalWinnerText.style.color = teamCssColors[winnerColor];
                finalTieText.textContent = `Ø¨Ù…Ø¬Ù…ÙˆØ¹ Ù†Ù‚Ø§Ø·: ${scores[winnerColor]}`;
                startConfetti();
                playAgainBtn.style.display = 'block';
                startTieBreakerBtn.style.display = 'none';
            } else {
                finalWinnerText.textContent = 'ØªØ¹Ø§Ø¯Ù„!';
                finalWinnerText.style.color = '#fff';
                finalTieText.textContent = `Ø§Ù„ÙØ§Ø¦Ø²ÙˆÙ† Ù‡Ù… ${winners.map(c => teamNames[c]).join(' Ùˆ ')} Ø¨Ù†Ù‚Ø§Ø·: ${maxScore}.`;
                playAgainBtn.style.display = 'none';
                startTieBreakerBtn.style.display = 'block';
            }

            showModal(finalWinnerModal);
        }

        function createTieBreakerBoard() {
            isTieBreakerRound = true;
            grid.className = 'grid size-14'; // Use a fixed grid size for tie-breaker
            grid.innerHTML = '';
            board = [];
            matchedPairsCount = 0;
            
            const tieBreakerPairs = [...tieBreakerEmojis, ...tieBreakerEmojis];
            shuffle(tieBreakerPairs);
            
            // Add one special square
            let specialValue = tieBreakerFixedValue;
            let randomIndex = Math.floor(Math.random() * tieBreakerPairs.length);
            tieBreakerPairs.splice(randomIndex, 0, 'â­');
            
            tieBreakerPairs.forEach((content, index) => {
                const cell = document.createElement('div');
                cell.classList.add('cell', 'hidden', 'text-content');
                if (content === 'â­') {
                    cell.dataset.content = 'â­';
                    cell.dataset.isSpecial = 'true';
                    cell.dataset.value = specialValue;
                    cell.innerHTML = `<span>â­</span>`;
                    cell.dataset.specialType = 'star-placeholder';
                } else {
                    cell.dataset.content = content;
                    cell.dataset.isSpecial = 'false';
                    cell.innerHTML = `<span>${content}</span>`;
                }
                
                cell.addEventListener('click', () => flipTieBreakerCard(cell));
                grid.appendChild(cell);
            });
            
            showAllCards(tieBreakerTimer);
        }

        function flipTieBreakerCard(cell) {
            if (lockBoard || cell.classList.contains('matched') || cell === firstPick) return;
            
            cell.classList.remove('hidden');

            if (cell.dataset.isSpecial === 'true') {
                scores[activeTeams[currentTeamIndex]] += parseInt(cell.dataset.value);
                cell.classList.add('value-revealed', 'positive');
                cell.innerHTML = `<span>+${cell.dataset.value}</span>`;
                cell.removeEventListener('click', () => flipTieBreakerCard(cell));
                updateScoreboard();
                
                setTimeout(() => {
                    cell.classList.remove('value-revealed', 'positive');
                    cell.classList.add('hidden');
                    cell.innerHTML = `<span>â­</span>`;
                }, 1500);
            } else {
                if (!firstPick) {
                    firstPick = cell;
                    firstPick.classList.add('revealed');
                    return;
                }
                
                lockBoard = true;
                let secondPick = cell;
                secondPick.classList.add('revealed');
                
                if (firstPick.dataset.content === secondPick.dataset.content) {
                    scores[activeTeams[currentTeamIndex]] += 20; // More points for tie-breaker match
                    firstPick.classList.add('matched');
                    secondPick.classList.add('matched');
                    firstPick.removeEventListener('click', () => flipTieBreakerCard(firstPick));
                    secondPick.removeEventListener('click', () => flipTieBreakerCard(secondPick));
                    matchedPairsCount++;
                } else {
                    scores[activeTeams[currentTeamIndex]] = Math.max(0, scores[activeTeams[currentTeamIndex]] - 10);
                    firstPick.classList.add('hidden');
                    secondPick.classList.add('hidden');
                }
                
                updateScoreboard();
                changeTurn();
                resetBoard();
                
                if (matchedPairsCount === tieBreakerTotalEmojiPairs) {
                    setTimeout(endGame, 2000);
                }
            }
        }

        function startConfetti() {
            const colors = ['#f44336', '#e91e63', '#9c27b0', '#673ab7', '#3f51b5', '#2196f3', '#03a9f4', '#00bcd4', '#009688', '#4caf50', '#8bc34a', '#cddc39', '#ffeb3b', '#ffc107', '#ff9800', '#ff5722'];
            const confettiCount = 100;
            const container = document.body;

            for (let i = 0; i < confettiCount; i++) {
                const confetti = document.createElement('div');
                confetti.classList.add('confetti');
                confetti.style.left = `${Math.random() * 100}vw`;
                confetti.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
                confetti.style.animationDuration = `${Math.random() * 3 + 2}s`;
                confetti.style.animationDelay = `${Math.random() * 0.5}s`;
                container.appendChild(confetti);
            }
            // Clean up confetti after it falls
            setTimeout(() => {
                document.querySelectorAll('.confetti').forEach(c => c.remove());
            }, 6000);
        }
        
        // Event listeners for buttons
        document.getElementById('playAgainBtn').addEventListener('click', () => {
            hideAllModals();
            resetGame();
        });

        document.getElementById('startTieBreakerBtn').addEventListener('click', () => {
            hideAllModals();
            isTieBreakerRound = true;
            startGameBtn.textContent = 'Ø¨Ø¯Ø¡ Ø¬ÙˆÙ„Ø© Ø§Ù„ØªØ¹Ø§Ø¯Ù„';
            startGameBtn.style.display = 'block';
            nextGroupBtn.style.display = 'none';
            resetGameBtn.disabled = false;
            handleStartOrNextRound();
        });

        function resetGame() {
            hideAllModals();
            gameInitialized = false;
            isTieBreakerRound = false;
            activeTeams = [];
            scores = {};
            currentTeamIndex = 0;
            startingTeamIndexForRound = 0;
            currentGroupIndex = 0;
            roundIndex = 0;
            matchedPairsCount = 0;
            if (timerInterval) {
                clearInterval(timerInterval);
            }
            grid.innerHTML = '';
            scoreboardDiv.innerHTML = '';
            resultDisplay.textContent = '';
            timerContainer.textContent = '';
            startGameBtn.textContent = 'Ø¨Ø¯Ø¡ Ø§Ù„Ø¬ÙˆÙ„Ø©';
            startGameBtn.style.display = 'none';
            nextGroupBtn.style.display = 'none';
            showModal(welcomeModal);
        }

        // Event listener for reset confirmation buttons
        confirmResetBtn.addEventListener('click', resetGame);
        cancelResetBtn.addEventListener('click', hideResetConfirmation);
        
        // Initial setup
        showModal(welcomeModal);

    </script>
</body>
</html>
